<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta property="og:title" content="Formulário de perguntas" />
    <meta property="og:image"
        content="https://instagram.fcgh4-2.fna.fbcdn.net/v/t51.2885-19/327010076_575372104089013_216381747825316785_n.jpg?stp=dst-jpg_e0_s150x150&_nc_ht=instagram.fcgh4-2.fna.fbcdn.net&_nc_cat=101&_nc_ohc=DYf7ECkVgpsQ7kNvgFiTXax&_nc_gid=527f744d389a44a3a192c3cc373a61b7&edm=AEYEu-QBAAAA&ccb=7-5&oh=00_AYAmQ0ejGAPIFxKKiTxvZE89ZFotsCoQnkbhlZQZpTi_6A&oe=6719C8D5&_nc_sid=ead929" />
    <meta property="og:url" content="https://esddsa-9b73f.web.app/" />
    <meta property="og:type" content="website" />

    <title>Ask</title>
    <link rel="stylesheet" href="style.css">
    <link rel="shortcut icon" href="favicon-32x32.png" type="image/x-icon">
    <script src="script.js" defer></script>
</head>

<body>
    <div class="container">
        <main>
            <div class="logo"><img src="logo.png" alt=""></div>
            <h1 class="title">
                Mande sua pergunta</h1>

            <input id="name" class="input" type="text" placeholder="Nome(opcional)" />

            <div class="coments">
                <label for="textarea">Sua pergunta aqui:</label>
                <textarea id="textarea" class="coments" name="coments" cols="30" rows="10">
                </textarea>

            </div>
            <div class="select">
                <select id="mensagens" name="mensagens">
                    <option value="" disabled selected>Tipo de pergunta...</option>
                    <option value="Oração">Pedido de Oração</option>
                    <option value="Dúvida">Dúvida Bíblica</option>
                    <option value="Aconselhamento">Conselho</option>
                    <option value="Sugestão">Sugestão de Melhorias/Projetos</option>
                    <option value="Outro">Outro</option>
                </select>
            </div>
            <button id="registerBtn" class="btn">Enviar</button>

            <p class="copy">© 2024 Representantes Do Reino. Todos os direitos reservados.</p>
        </main>

    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.2/firebase-app.js";
        import { getAuth, createUserWithEmailAndPassword, sendEmailVerification } from 'https://www.gstatic.com/firebasejs/10.13.2/firebase-auth.js';
        import { getDatabase, ref, set, get, child } from "https://www.gstatic.com/firebasejs/10.13.2/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyD7NdmsHN_DoQbYG73eSmKZ1z30TzmD8q8",
            authDomain: "sjurados-7419f.firebaseapp.com",
            projectId: "sjurados-7419f",
            storageBucket: "sjurados-7419f.appspot.com",
            messagingSenderId: "10558815651",
            appId: "1:10558815651:web:26ac9f7df3ecc3957eae16",
            measurementId: "G-FWL86VHD3S",
            databaseURL: "https://sjurados-7419f-default-rtdb.firebaseio.com"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getDatabase(app);

        const handleSaveData = async () => {
            const name = document.getElementById('name')
            const coments = document.getElementById('textarea').value;
            const mensagens = document.getElementById('mensagens').value;
            const textarea = document.getElementById('textarea');

           

            // Função que posiciona o cursor no início (posição 0)
            function setCursorToStart(element) {
                requestAnimationFrame(() => {
                    element.setSelectionRange(0, 0); // Posiciona o cursor no início
                });
            }

            const currentDate = new Date().toLocaleString();

            const nome = name == '' ? 'Anônimo(a)' : name.value




            try {
                await set(ref(db, "perguntas/" + `${mensagens}`), {
                    nome: nome,
                    tipoDePergunta: mensagens,
                    pergunta: coments,
                    data: currentDate

                })
                alert('Pergunta Enviada!')
            } catch (error) {
                alert('Falha em enviar a pergunta, tente novamente ou entre em contato com o desenvolvedor!')
            }


        };

        document.getElementById('registerBtn').addEventListener("click", handleSaveData);
    </script>
</body>

</html>